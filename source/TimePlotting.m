clear; clc; close all
type = 'Rand';

if strcmp(type,'Freq')
    A = [100 906
102400 1837
1600 1388
1638400 1913
25600 1755
400 1137
409600 1878
6400 1620
    ]; 

    q = [100 942
102400 998
1600 990
1638400 1000
25600 997
400 968
409600 999
6400 995
    ];
elseif strcmp(type,'InFreq')
    A = [100 0.000028
102400 0.011104
1600 0.000264
1638400 0.861397
25600 0.003457
400 0.000064
409600 0.064036
6400 0.000924
    ]; 

    q = [100 0
102400 2
1600 1
1638400 45
25600 1
400 0
409600 8
6400 1
    ];
else
    A = [100 0.000061
    102400 1.996967
    1600 0.002420
    1638400 354.728058
    25600 0.163876
    400 0.000233
    409600 26.673212
    6400 0.008320
    ]; 

    q = [100 0
    102400 96
    1600 4
    1638400 916
    25600 47
    400 0
    409600 341
    6400 3
    ];
end
    
A2 = [100 0.000000
102400 0.016318
1600 0.000048
1638400 3.629982
25600 0.001832
400 0.000001
409600 0.039805
6400 0.000060

];

A3 = [100 0.000001
102400 0.007940
1600 0.000021
1638400 4.226668
25600 0.001849
400 0.000001
409600 0.041837
6400 0.000058
];



q(q(:,2)==0) = inf;

[s id] = sort(A(:,1));

%semilogx((A(id,1)),(A(id,2)./q(id,2)));
semilogx((A(id,1)),(A(id,2)./q(id,2))./(A2(id,2)./q(id,2)),(A(id,1)),(A(id,2)./q(id,2))./(A3(id,2)./q(id,2)));

title(['Speedup Factor vs dimension of the vocablary: ' type ' Terms']);
xlabel('Dimension in log scale');
ylabel('Speedup against Brute Force');
legend('Approx - 20%', 'Approx - 50%'); 